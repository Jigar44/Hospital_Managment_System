{% extends 'admin/home.html' %}
{% block body %}
<div class="main">
  <div class="row">
      <center><h2>Search Patient</h2></center>
    <form action="{{url_for('search_patients')}}" method="post">
        <label for="sid">Enter SSN ID*</label>
        <input type="number" name="ssnid" id="ssnid" required min="1"/>
        <p>OR!</p>
        <label for="sid">Enter Patient ID*</label>
        <input type="number" name="pid" id="pid" required min="1"/>
        <br>
        <input type="submit" name="submit" value="submit" required/>
    </form>
    <br>
    <br>

    {% if data_all and session.get('role')=='admin' %}
    <table style="width:100%">
        <tr>
            <th>Patient ID</th>
            <th>SSN ID</th>
            <th>Patient Name</th>
            <th>Age</th>
            <th>Type of Bed</th>
            <th>Patient Status</th>
            <th>Address</th>
            <th>State</th>
            <th>City</th>
            <th>Admit Date</th>
        </tr>
    
        <tr>
            <td>{{data_all.pid}}</td>
            <td>{{data_all.ssnid}}</td>
            <td>{{data_all.pname}}</td>
            <td>{{data_all.age}}</td>
            <td>{{data_all.bedtype}}</td>
            <td>{{data_all.pstatus}}</td>
            <td>{{data_all.address}}</td>
            <td>{{data_all.state}}</td>
            <td>{{data_all.city}}</td>
            <td>{{data_all.admitdate}}</td>
        </tr>
    </table>
    
    <form action="/admin/update" method="POST">
    <input type="hidden" value="{{data_all.pid}}" name="pid" />
    <button name="submit" value="update_patient" type="submit">Update Patient</a></button>
    </form>
    
    <form action="/admin/delete" method="POST" onsubmit="return confirm('Confirm Patient Delete?!')">
        <input type="hidden" value="{{data_all.pid}}" name="pid" />
        <button name="submit" value="delete_patient" type="submit">Delete Patient</a></button>
        </form>
    

    {% endif %}

    {% if data_active and (session.get('role')=='pharmacist' or session.get('role')=='diagnostic') %}
    <table style="width:100%">
        <tr>
            <th>Patient ID</th>
            <th>SSN ID</th>
            <th>Patient Name</th>
            <th>Age</th>
            <th>Type of Bed</th>
            <th>Patient Status</th>
            <th>Address</th>
            <th>State</th>
            <th>City</th>
            <th>Admit Date</th>
        </tr>
    
        <tr>
            <td>{{data_active.pid}}</td>
            <td>{{data_active.ssnid}}</td>
            <td>{{data_active.pname}}</td>
            <td>{{data_active.age}}</td>
            <td>{{data_active.bedtype}}</td>
            <td>{{data_active.pstatus}}</td>
            <td>{{data_active.address}}</td>
            <td>{{data_active.state}}</td>
            <td>{{data_active.city}}</td>
            <td>{{data_active.admitdate}}</td>
        </tr>
    </table>
    
    {% endif %}

{% if data_active and session.get('role')=='pharmacist'  %}
    <form action="{{url_for('issuemed_search')}}" method="POST">
        <input type="hidden" value="{{data_active.pid}}" name="pid" />
        <input type="hidden" value="{{data_active.pname}}" name="pname" />
        <button name="submit" value="issuemed_search" type="submit">Issue New Medicine to Patient</a></button>
        </form>
        {% endif %}
{% if data_active and session.get('role')=='diagnostic'  %}
<form action="{{url_for('issuetest_search')}}" method="POST">
            <input type="hidden" value="{{data_active.pid}}" name="pid" />
            <input type="hidden" value="{{data_active.pname}}" name="pname" />
            <button name="submit" value="issuetest_search" type="submit">Add Diagnostic Tests for Patient</a></button>
            </form>
            {% endif %} 

    <br>
    <br>

    <input type="button" value="Back" onclick="history.back()">
</div>
</div>

<script >
    $(document).ready(function(){
$('#ssnid').blur(function(){
    if($(this).val().length != 0){
        $('#pid').attr('disabled', true);
    }
    else{
        $('#pid').attr('disabled', false);
    }       
});
$('#pid').blur(function(){
    if($(this).val().length != 0){
        $('#ssnid').attr('disabled', true);
    }
    else{
        $('#ssnid').attr('disabled', false);
    }        
});
});
</script>

<script>
    $(document).ready(function () {
        window.history.replaceState("", "", window.location.href);
    });
</script>

{% endblock %}
