{% extends 'layout.html' %}
{% block title %}pharmacist{% endblock %}
{% block body %}
<!-- Displays All Medecines Currently issued to Specific Patient if any -->
{% if data_medissue %}
<p class="text-center text-white" style="margin-top: 30px;" >Medicine Issued to patient ID: {{pdata['pid']}} | Name : {{pdata['pname']}}</p>

<table class="table">
  <thead class="thead-dark">
    <tr>
      <th>Medicine ID</th>
      <th>Medicine Name</th>
      <th>Current Quantity</th>
      <th>Rate</th>
      <th>Amount</th>
  </thead>
  </tr>
  <tbody>
    {% for data in data_medissue %}
    <tr>
      <td>{{data.medid}}</td>
      <td>{{data.medname}}</td>
      <td>{{data.quantity}}</td>
      <td>{{data.rate}}</td>
      <td>{{data.amount}}</td>
    </tr>
    {% endfor %}
  </tbody>

</table>

{% else %}
<center style="margin-top: 30px;">
  <h3>No Issued medicines records found!</h3>
</center>
{% endif %}

<!-- end show issued medicine -->

<!-- show available medicines in the inventory from which pharmacist can issue meds
     to patient if inventory not empty -->
<br>
<div class="main">
  
  <div class="row justify-content-center">
    <div class="col-md-7">
      <button class="btn btn-primary" id="bissuemedadd">Issue new Medicine</button>
      {% if data_allmed %}
      <form action="/pharmacist/issuemedicine" class="text-white" method="post" onsubmit="return issuevalidation()" id="issuenewmedform" style="display: none;">
        <div class="row justify-content-center">
          <div class="col-md-8">
            <div class="form-bg form-style-patient">
              <div class="row justify-content-center">
                <div class="col-md-12">
                  <h2>Issue Medicine</h2><br />
                </div>
              </div>
              <input type="hidden" name="pid" value="{{pdata['pid']}}" />
              <input type="hidden" name="pname" value="{{pdata['pname']}}" />

              <div class="form-group row justify-content-center">
                <label class="col-md-5 col-form-label">Enter Medicine Name</label>
                <div class="col-md-6">
                  <input class="form-control"  name="medname" id="medname" required type="text" />
                  <span class="text-danger font-weight-bold" id="mednamespan"></span>
                </div>
              </div>

              <div class="form-group row justify-content-center">
                <label class="col-md-5 col-form-label">Quantity</label>
                <div class="col-md-6">
                  <input class="form-control" min="0" name="quantity" id="quantity" required type="number" />
                  <span class="text-danger font-weight-bold" id="quantityspan"></span>
                </div>
              </div>

              <button class="btn btn-primary" name="submit" type="submit" value="issuemed_add">Confirm Add!</button>
              <button class="btn btn-warning" type="reset" value="Reset">Reset</button>
            </div>
          </div>
        </div>
      </form>
    </div>
  </div>
</div>
<h4 class="text-white text-center" style="margin-top: 50px;" >Medicine Available</h4>
<table class="table">  
  <thead class="thead-dark">    
    <tr>
      <th>Medicine ID</th>
      <th>Medicine Name</th>
      <th>Current Quantity</th>
      <th>Rate</th>
    </tr>
    </thead class="text-center">
    {% for data in data_allmed %}
    <tr>
      <td>{{data.medid}}</td>
      <td>{{data.medname}}</td>
      <td>{{data.quantity}}</td>
      <td>{{data.rate}}</td>
    </tr>
    {% endfor %}
</table>

<br />

<button class="btn btn-primary" id="add" name="resupply">
  <a class="text-white"  href="{{url_for('resupply_medicines')}}">Add/Resupply Medicines</a>
</button>

{% else %}

<p>No Medicine Available in the Inventory! Add new Medicine</p>

<button class="btn-primary" id="add" name="resupply">
  <a class="text-white" href="{{url_for('resupply_medicines')}}">Add/Resupply Medicines</a>
</button>

{% endif %}



<input class="btn btn-warning" type="button" value="Back" onclick="history.back()" />


<!-- ============================= JS validataion=================== -->
<script>
  $(document).ready(function () {
    window.history.replaceState("", "", window.location.href);
  });
</script>

<script>
  $(document).ready(function () {
    $("#bissuemedadd").click(function () {
      $("#issuenewmedform").show();

    });
  });
</script>

{% endblock %}