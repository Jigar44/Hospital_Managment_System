{% extends 'pharmacist/home.html' %}
{% block body %}

<div class="main">
  <button class="btn-primary" id="badd">Add new Medicine</button>

  <div class="row justify-content-center">
    <div class="col-md-10">
      <form action="/pharmacist/resupply" method="post" class="text-white" onsubmit="return addvalidation()"
        id="addform" style="display: none;">
        <div class="row justify-content-center">
          <div class="col-md-8">
            <div class="form-bg form-style-patient">
              <div class="row justify-content-center">
                <div class="col-md-12">
                  <h2>Resupply Medicine</h2><br />
                </div>
              </div>
              <div class="form-group row justify-content-center">
                <label class="col-md-3 col-form-label"> Medicine ID</label>
                <div class="col-md-6">
                  <input class="form-control" name="addmedid" id="addmedid" required type="number" />
                  <span class="text-danger font-weight-bold" id="addmedidspan"></span>
                </div>
              </div>

              <div class="form-group row justify-content-center">
                <label class="col-md-3 col-form-label"> Medicine Name</label>
                <div class="col-md-6">
                  <input class="form-control" name="addmedname" id="addmedname" required type="text" />
                  <span class="text-danger font-weight-bold" id="addmednamespan"></span>
                </div>
              </div>

              <div class="form-group row justify-content-center">
                <label class="col-md-3 col-form-label"> Quantity</label>
                <div class="col-md-6">
                  <input class="form-control" min="0" max="10000" name="addquantity" id="addquantity" required type="number" />
                  <span class="text-danger font-weight-bold" id="addquantityspan"></span>
                </div>
              </div>

              <div class="form-group row justify-content-center">
                <label class="col-md-3 col-form-label"> Rate</label>
                <div class="col-md-6">
                  <input class="form-control" name="addrate" id="addrate" required type="number" min="0"
                    step="0.0001" />
                  <span class="text-danger font-weight-bold" id="addratespan"></span>
                </div>
              </div>

              <button class="btn-primary" name="submit" type="submit" value="add">Confirm Add!</button>
              <button class="btn-warning" type="reset" value="Reset">Reset</button>

      </form>
    </div>
  </div>
</div>
</div>
</div>
</div>


{% if med_data%}
<table class="table">
  <thead class="thead-dark">
    <tr style="text-align: center;">
      <th>Medicine ID</th>
      <th>Medicine Name</th>
      <th>Current Quantity</th>
      <th>Rate</th>
      <th>Action</th>
    </tr>

  <tbody>
    {% for data in med_data %}

    <tr style="text-align: center;">
      <th>{{data.medid}}</th>
      <th>{{data.medname}}</th>
      <th>{{data.quantity}}</th>
      <th>{{data.rate}}</th>
      <th>

        <button id="{{data.medid}}" value="{{data.medid}}" class="updbtn btn-warning">
          Add Quantity
        </button>
      </th>
    </tr>
  </tbody>
  {% endfor %}
</table>
{% else %}
<p>No Medicine Available in the Inventory! Add new Medicine</p>
{% endif %}


<div class="main">

  <div class="row justify-content-center">
    <div class="col-md-10">
      <form action="/pharmacist/resupply" class="text-white" method="post" onsubmit="return updatevalidation()"
        id="updateform" style="display: none;">
        <div class="row justify-content-center">
          <div class="col-md-6">
            <div class="form-bg form-style-patient">
              <div class="row justify-content-center">
                <div class="col-md-12">
                  <h2>Update Quantity</h2><br>
                </div>
              </div>

              <div class="form-group row justify-content-center">
                <label class="col-md-3 col-form-label"> Medicine ID</label>
                <div class="col-md-6">
                  <input class="form-control" name="updatemedid" id="updatemedid" readonly type="number" />
                  <span class="text-danger font-weight-bold" id="updatemedidspan"></span>
                </div>
              </div>

              <div class="form-group row justify-content-center">
                <label class="col-md-3 col-form-label"> Quantity</label>
                <div class="col-md-6">
                  <input class="form-control" min="0" max="10000" name="updatequantity" id="updatequantity" required
                    type="number" />
                  <span class="text-danger font-weight-bold" id="updatequantityspan"></span>
                </div>
              </div>

              <div class="row justify-content-center">
                <button class="btn-primary" type="submit" name="submit" value="update">Update</button>
                <button class="btn-warning" type="reset" value="Reset">Reset</button>
              </div>
      </form>
    </div>
  </div>
</div>
</div>
</div>
</div>
<!-- <input class="form-control" type="button" value="Back" onclick="history.back()" /> -->


<script type="text/javascript">
  function updatevalidation() {
    var validate = true;
    document.getElementById("updatemedidspan").innerHTML = "";
    var updatemedid = document.getElementById("updatemedid").value;

    if (updatemedid.length != 9) {
      document.getElementById("updatemedidspan").innerHTML =
        "Enter 9 digit medID, given input length is :" + updatemedid.length;
      validate = false;
    }
    return validate;
  }

  function addvalidation() {
    var validate = true;
    document.getElementById("addmedidspan").innerHTML = "";
    document.getElementById("addmednamespan").innerHTML = "";
    var addmedid = document.getElementById("addmedid").value;

    if (addmedid.length != 9) {
      document.getElementById("addmedidspan").innerHTML =
        "Enter 9 digit medID, given input length is :" + addmedid.length;
      validate = false;
    }

    //Patient name
    var addmedname = document.getElementById("addmedname").value;
    // console.log("addmedname : "+ addmedname)
    // console.log(addmedname.match("^[a-zA-Z]+.*[\s][a-zA-Z]+$"))
    if (!addmedname.match("^[a-zA-Z]+$")) {
      document.getElementById("addmednamespan").innerHTML =
        "Enter Alphabetical Medicine Name";
      validate = false;
    }
    return validate;
  }
</script>

<script>
  $(document).ready(function () {
    window.history.replaceState("", "", window.location.href);
  });
</script>

<script>
  $(document).ready(function () {
    $("#badd").click(function () {
      $("#addform").show();
      $("#updateform").hide();
    });
    $(".updbtn").click(function () {
      $("#addform").hide();
      $("#updateform").show();
      $("#updatemedid").val($(this).val());
    });
  });
</script>


{% endblock %}